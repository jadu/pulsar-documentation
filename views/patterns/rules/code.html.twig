{% extends '@pulsar/pulsar/components/tab.html.twig' %}
{% import 'helpers/example.html.twig' as docs %}

{% block tab_content %}
<div class="report">
    <p class="lede">The Rules pattern allow users to build up a conditional logic statement in a visual way.</p>

    {{ docs.heading('h2', 'Anatomy of a rule') }}

    <p>A complete rule is made up of blocks, which define specific conditions, and links, which allow additional blocks to be added.</p> 

<pre><code lang="sh">── Rule container
    └── rule block
        └── rule block header
        └── rule block controls
            └── rule block control
    └── rule links
        └── rule link</code></pre>

    <p>For a rule which is structured in the IF/AND/OR/RETURN format, the blocks and links are typically arranged within the following example heirarchy.</p>

<pre><code lang="sh">── IF block
|  |  └── OR link
|  |── AND block
|  |  └── OR link
|  |─── AND link
|  └── RETURN block
|── ELSE IF link
└── ELSE RETURN block</code></pre>

    {{ docs.heading('h2', 'Rule blocks') }}

    <p>A rule block represents a single logical condition that must be matched for the rule to take this route. The controls within the rule block will be specific to the context of the parent user interface.</p>

    <p>The rule classes define how the block is visually styled, the block must use the parent <code>.rule-block</code> class.</p>

    <ul>
        <li><code>.rule-block--if</code></li>
        <li><code>.rule-block--and</code></li>
        <li><code>.rule-block--or</code></li>
        <li><code>.rule-block--else-if</code></li>
        <li><code>.rule-block--return</code></li>
        <li><code>.rule-block--else-return</code></li>
    </ul>

    {{ docs.example({
        html: "<div id=\"rule-form-container\" class=\"rules-container rules-container--v2\">
    <div class=\"rule-block rule-block--if\">
        <div class=\"rule-block__header\">
            <span class=\"rule-block__heading\">if</span>
        </div>
        <div class=\"rule-block__controls\">
            <div class=\"rule-block__control\">
                <div class=\"form__group form__group--medium\">
                    <label class=\"control__label hide\">Choose condition</label>
                    <div class=\"controls\">
                        <select placeholder=\"Choose condition\" class=\"form__control select js-select2 select2-hidden-accessible\" tabindex=\"-1\" aria-hidden=\"true\">
                            <option value=\"foo\">Choose condition</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class=\"rule-block__control\">
                <div class=\"form__group form__group--small\"><label class=\"control__label hide\">Choose</label>
                    <div class=\"controls\">
                        <select placeholder=\"Choose\" class=\"form__control select\">
                            <option value=\"foo\">is</option>
                            <option value=\"foo\">is not</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class=\"rule-block__control\">
                 <div class=\"form__group form__group--medium\">
                    <label class=\"control__label hide\">Choose value</label>
                    <div class=\"controls\">
                        <select placeholder=\"Choose value\" class=\"form__control select js-select2 select2-hidden-accessible\" tabindex=\"-1\" aria-hidden=\"true\">
                            <option value=\"foo\">Choose value</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
    " }) }}

    {{ docs.heading('h3', 'Removeable blocks') }}

    <p>Any blocks that a user has added by using the rule links should be removeable, this is achieved by adding the remove control as the last child of the rule block. These controls should also be present if a saved rule is loaded.</p>

    <p>The first IF block, as well as all RETURN and ELSE RETURN blocks should not be removeable.</p>

    {{ docs.example({
        html: "<div id=\"rule-form-container\" class=\"rules-container rules-container--v2\">
    <div class=\"rule-block rule-block--and\">
        <div class=\"rule-block__header\">
            <span class=\"rule-block__heading\">And</span>
        </div>
        <div class=\"rule-block__controls\">
            <div class=\"rule-block__control\">
                <div class=\"form__group form__group--medium\">
                    <label class=\"control__label hide\">Choose condition</label>
                    <div class=\"controls\">
                        <select placeholder=\"Choose condition\" class=\"form__control select js-select2 select2-hidden-accessible\" tabindex=\"-1\" aria-hidden=\"true\">
                            <option value=\"foo\">Choose condition</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <button data-action=\"remove\" data-tippy-content=\"Remove this item\" data-tippy-placement=\"left\" class=\"remove__control js-remove-condition\"><i  class=\"icon-remove-sign\"><span class=\"hide\">Remove this item</span></i></button>
    </div>
</div>
    " }) }}

    {{ docs.heading('h3', 'Indented blocks') }}

    <p>When an OR block immediately follows an IF, AND or ELSE-IF rule, it should be indented using a <code>.rule-block--indent</code> wrapper. Any rule links relating to this indented block should also be contained within the indent wrapper to maintain the layout of the ruleset.</p>

    <p>If an OR block follows another OR block, it does not need to be further indented.</p>

    {{ docs.example({
        twig: "
<div id=\"rule-form-container\" class=\"rules-container rules-container--v2\">

    <div class=\"rule-block rule-block--if\">
        <div class=\"rule-block__header\">
            <span class=\"rule-block__heading\">if</span>
        </div>
        <div class=\"rule-block__controls\">
            <div class=\"rule-block__control\">
                <div class=\"form__group form__group--medium\">
                    <label class=\"control__label hide\">Choose condition</label>
                    <div class=\"controls\">
                        <select placeholder=\"Choose condition\" class=\"form__control select js-select2 select2-hidden-accessible\" tabindex=\"-1\" aria-hidden=\"true\">
                            <option value=\"foo\">Choose condition</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class=\"rule-block--indent\">

        <div class=\"rule-block rule-block--or\">
            <div class=\"rule-block__header\">
                <span class=\"rule-block__heading\">or</span>
            </div>
            <div class=\"rule-block__controls\">
                <div class=\"rule-block__control\">
                    <div class=\"form__group form__group--medium\">
                        <label class=\"control__label hide\">Choose condition</label>
                        <div class=\"controls\">
                            <select placeholder=\"Choose condition\" class=\"form__control select js-select2 select2-hidden-accessible\" tabindex=\"-1\" aria-hidden=\"true\">
                                <option value=\"foo\">Choose condition</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <button data-action=\"remove\" data-tippy-content=\"Remove this item\" data-tippy-placement=\"left\" class=\"remove__control js-remove-condition\"><i  class=\"icon-remove-sign\"><span class=\"hide\">Remove this item</span></i></button>
        </div>

        <div class=\"rule-block rule-block--or\">
            <div class=\"rule-block__header\">
                <span class=\"rule-block__heading\">or</span>
            </div>
            <div class=\"rule-block__controls\">
                <div class=\"rule-block__control\">
                    <div class=\"form__group form__group--medium\">
                        <label class=\"control__label hide\">Choose condition</label>
                        <div class=\"controls\">
                            <select placeholder=\"Choose condition\" class=\"form__control select js-select2 select2-hidden-accessible\" tabindex=\"-1\" aria-hidden=\"true\">
                                <option value=\"foo\">Choose condition</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <button data-action=\"remove\" data-tippy-content=\"Remove this item\" data-tippy-placement=\"left\" class=\"remove__control js-remove-condition\"><i  class=\"icon-remove-sign\"><span class=\"hide\">Remove this item</span></i></button>
        </div>

        <div class=\"rule-links\">
            <div class=\"rule-link rule-link--or\">
                <button class=\"btn\" aria-label=\"Add a new OR condition\">or</button>
            </div>
        </div>

    </div><!-- /.ruleblock--indent -->

    ...

</div><!-- /.rules-container -->
    " }) }}

    {{ docs.heading('h2', 'Ruleset examples') }}

    {{ docs.heading('h3', 'Basic') }}

    <p>The rule controls used here are intentionally left blank.</p>

    {{ docs.example({
        html: "
<div id=\"rule-form-container\" class=\"rules-container rules-container--v2\">

    <div class=\"rule-block rule-block--if\">
        <div class=\"rule-block__header\">
            <span class=\"rule-block__heading\">if</span>
        </div>
        <div class=\"rule-block__controls\">
            <div class=\"rule-block__control\">
                <div class=\"form__group form__group--medium\">
                    <label class=\"control__label hide\">Choose condition</label>
                    <div class=\"controls\">
                        <select placeholder=\"Choose condition\" class=\"form__control select js-select2 select2-hidden-accessible\" tabindex=\"-1\" aria-hidden=\"true\">
                            <option value=\"foo\">Choose condition</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class=\"rule-links\">
        <div class=\"rule-link rule-link--or\">
            <button class=\"btn\" aria-label=\"Add a new OR condition\">or</button>
        </div>
        <div class=\"rule-link rule-link--and\">
            <button class=\"btn\" aria-label=\"Add a new AND condition\">and</button>
        </div>
    </div>

    <div class=\"rule-block rule-block--return\">
        <div class=\"rule-block__header\">
            <span class=\"rule-block__heading\">return</span>
        </div>
        <div class=\"rule-block__controls\">
            <div class=\"rule-block__control\">
                <div class=\"form__group form__group--medium\">
                    <label class=\"control__label hide\">Choose condition</label>
                    <div class=\"controls\">
                        <select placeholder=\"Choose condition\" class=\"form__control select js-select2 select2-hidden-accessible\" tabindex=\"-1\" aria-hidden=\"true\">
                            <option value=\"foo\">Choose return value</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class=\"rule-links\">
        <div class=\"rule-link rule-link--else-if\">
            <button class=\"btn\">else if</button>
        </div>
    </div>
    
    <div class=\"rule-block rule-block--else-return\">
        <div class=\"rule-block__header\">
            <span class=\"rule-block__heading\">else return</span>
        </div>
        <div class=\"rule-block__controls\">
            <div class=\"rule-block__control\">
                <div class=\"form__group form__group--medium\">
                    <label class=\"control__label hide\">Choose condition</label>
                    <div class=\"controls\">
                        <select placeholder=\"Choose condition\" class=\"form__control select js-select2 select2-hidden-accessible\" tabindex=\"-1\" aria-hidden=\"true\">
                            <option value=\"foo\">Choose return value</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div><!-- /.rules-container -->
    " }) }}

    {{ docs.heading('h2', 'Full') }}

    <p>The rule controls used here are intentionally left blank.</p>

    {{ docs.example({
        twig: "
<div id=\"rule-form-container\" class=\"rules-container rules-container--v2\">

    <div class=\"rule-block rule-block--if\">
        <div class=\"rule-block__header\">
            <span class=\"rule-block__heading\">if</span>
        </div>
        <div class=\"rule-block__controls\">
            <div class=\"rule-block__control\">
                <div class=\"form__group form__group--medium\">
                    <label class=\"control__label hide\">Choose condition</label>
                    <div class=\"controls\">
                        <select placeholder=\"Choose condition\" class=\"form__control select js-select2 select2-hidden-accessible\" tabindex=\"-1\" aria-hidden=\"true\">
                            <option value=\"foo\">Choose condition</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class=\"rule-block--indent\">

        <div class=\"rule-block rule-block--or\">
            <div class=\"rule-block__header\">
                <span class=\"rule-block__heading\">or</span>
            </div>
            <div class=\"rule-block__controls\">
                <div class=\"rule-block__control\">
                    <div class=\"form__group form__group--medium\">
                        <label class=\"control__label hide\">Choose condition</label>
                        <div class=\"controls\">
                            <select placeholder=\"Choose condition\" class=\"form__control select js-select2 select2-hidden-accessible\" tabindex=\"-1\" aria-hidden=\"true\">
                                <option value=\"foo\">Choose condition</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <button data-action=\"remove\" data-tippy-content=\"Remove this item\" data-tippy-placement=\"left\"  class=\"remove__control js-remove-condition\"><i  class=\"icon-remove-sign\"><span class=\"hide\">Remove this item</span></i></button>
        </div>

        <div class=\"rule-block rule-block--or\">
            <div class=\"rule-block__header\">
                <span class=\"rule-block__heading\">or</span>
            </div>
            <div class=\"rule-block__controls\">
                <div class=\"rule-block__control\">
                    <div class=\"form__group form__group--medium\">
                        <label class=\"control__label hide\">Choose condition</label>
                        <div class=\"controls\">
                            <select placeholder=\"Choose condition\" class=\"form__control select js-select2 select2-hidden-accessible\" tabindex=\"-1\" aria-hidden=\"true\">
                                <option value=\"foo\">Choose condition</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <button data-action=\"remove\" data-tippy-content=\"Remove this item\" data-tippy-placement=\"left\" class=\"remove__control js-remove-condition\"><i  class=\"icon-remove-sign\"><span class=\"hide\">Remove this item</span></i></button>
        </div>

        <div class=\"rule-links\">
            <div class=\"rule-link rule-link--or\">
                <button class=\"btn\" aria-label=\"Add a new OR condition\">or</button>
            </div>
        </div>

    </div><!-- /.ruleblock--indent -->

    <div class=\"rule-block rule-block--and\">
        <div class=\"rule-block__header\">
            <span class=\"rule-block__heading\">and</span>
        </div>
        <div class=\"rule-block__controls\">
                <div class=\"rule-block__control\">
                    <div class=\"form__group form__group--medium\">
                        <label class=\"control__label hide\">Choose condition</label>
                        <div class=\"controls\">
                            <select placeholder=\"Choose condition\" class=\"form__control select js-select2 select2-hidden-accessible\" tabindex=\"-1\" aria-hidden=\"true\">
                                <option value=\"foo\">Choose condition</option>
                            </select>
                        </div>
                    </div>
                </div>
        </div>
        <button data-action=\"remove\" data-tippy-content=\"Remove this item\" data-tippy-placement=\"left\" class=\"remove__control js-remove-condition\"><i  class=\"icon-remove-sign\"><span class=\"hide\">Remove this item</span></i></button>
    </div>

    <div class=\"rule-block--indent\">
        <div class=\"rule-block rule-block--or\">
            <div class=\"rule-block__header\">
                <span class=\"rule-block__heading\">or</span>
            </div>
            <div class=\"rule-block__controls\">
                <div class=\"rule-block__control\">
                    <div class=\"form__group form__group--medium\">
                        <label class=\"control__label hide\">Choose condition</label>
                        <div class=\"controls\">
                            <select placeholder=\"Choose condition\" class=\"form__control select js-select2 select2-hidden-accessible\" tabindex=\"-1\" aria-hidden=\"true\">
                                <option value=\"foo\">Choose condition</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <button data-action=\"remove\" data-tippy-content=\"Remove this item\" data-tippy-placement=\"left\"  class=\"remove__control js-remove-condition\"><i  class=\"icon-remove-sign\"><span class=\"hide\">Remove this item</span></i></button>
        </div>

        <div class=\"rule-links\">
            <div class=\"rule-link rule-link--or\">
                <button class=\"btn\" aria-label=\"Add a new OR condition\">or</button>
            </div>
        </div>
    </div><!-- /.ruleblock--indent -->

    <div class=\"rule-links\">
        <div class=\"rule-link rule-link--and\">
            <button class=\"btn\" aria-label=\"Add a new AND condition\">and</button>
        </div>
    </div>

    <div class=\"rule-block rule-block--return\">
        <div class=\"rule-block__header\">
            <span class=\"rule-block__heading\">return</span>
        </div>
        <div class=\"rule-block__controls\">
            <div class=\"rule-block__control\">
                <div class=\"form__group form__group--medium\">
                    <label class=\"control__label hide\">Choose condition</label>
                    <div class=\"controls\">
                        <select placeholder=\"Choose condition\" class=\"form__control select js-select2 select2-hidden-accessible\" tabindex=\"-1\" aria-hidden=\"true\">
                            <option value=\"foo\">Choose return value</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class=\"rule-links\">
        <div class=\"rule-link rule-link--else-if\">
            <button class=\"btn\">else if</button>
        </div>
    </div>

    <div class=\"rule-block rule-block--else-if\">
        <div class=\"rule-block__header\">
            <span class=\"rule-block__heading\">else if</span>
        </div>
        <div class=\"rule-block__controls\">
                <div class=\"rule-block__control\">
                    <div class=\"form__group form__group--medium\">
                        <label class=\"control__label hide\">Choose condition</label>
                        <div class=\"controls\">
                            <select placeholder=\"Choose condition\" class=\"form__control select js-select2 select2-hidden-accessible\" tabindex=\"-1\" aria-hidden=\"true\">
                                <option value=\"foo\">Choose condition</option>
                            </select>
                        </div>
                    </div>
                </div>
        </div>
        <button data-action=\"remove\" data-tippy-content=\"Remove this item\" data-tippy-placement=\"left\" class=\"remove__control js-remove-condition\"><i  class=\"icon-remove-sign\"><span class=\"hide\">Remove this item</span></i></button>
    </div>    

    <div class=\"rule-links\">
        <div class=\"rule-link rule-link--or\">
            <button class=\"btn\" aria-label=\"Add a new OR condition\">or</button>
        </div>
        <div class=\"rule-link rule-link--and\">
            <button class=\"btn\" aria-label=\"Add a new AND condition\">and</button>
        </div>
    </div>

    <div class=\"rule-block rule-block--return\">
        <div class=\"rule-block__header\">
            <span class=\"rule-block__heading\">return</span>
        </div>
        <div class=\"rule-block__controls\">
            <div class=\"rule-block__control\">
                <div class=\"form__group form__group--medium\">
                    <label class=\"control__label hide\">Choose condition</label>
                    <div class=\"controls\">
                        <select placeholder=\"Choose condition\" class=\"form__control select js-select2 select2-hidden-accessible\" tabindex=\"-1\" aria-hidden=\"true\">
                            <option value=\"foo\">Choose return value</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class=\"rule-links\">
        <div class=\"rule-link rule-link--else-if\">
            <button class=\"btn\">else if</button>
        </div>
    </div>

    <div class=\"rule-block rule-block--else-return\">
        <div class=\"rule-block__header\">
            <span class=\"rule-block__heading\">else return</span>
        </div>
        <div class=\"rule-block__controls\">
            <div class=\"rule-block__control\">
                <div class=\"form__group form__group--medium\">
                    <label class=\"control__label hide\">Choose condition</label>
                    <div class=\"controls\">
                        <select placeholder=\"Choose condition\" class=\"form__control select js-select2 select2-hidden-accessible\" tabindex=\"-1\" aria-hidden=\"true\">
                            <option value=\"foo\">Choose return value</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div><!-- /.rules-container -->
    " }) }}

    {{ docs.heading('h2', 'Interactions') }}

    <p>Currently, there is no associated JavaScript component to enable interactions for the rules user interface. This is due to the singular implementation of this pattern within the XFP product.</p>


</div>
{% endblock tab_content %}
{% block tab_sidebar %}
    {{ docs.toc() }}
{% endblock tab_sidebar %}